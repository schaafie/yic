(()=>{"use strict";const t=document.createElement("template");t.innerHTML='<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\n#top-menu-bar {\n    background-color: #eee;\n    border-top: 2px outset #aaa;\n    border-bottom: 2px inset #aaa;\n    overflow: hidden;\n}\n  \n/* Navbar links */\n#top-menu-bar a {\n    float: left;\n    display: block;\n    text-align: center;\n    padding: 14px 16px;\n    text-decoration: none;\n    color: #333333;\n}\n\n#top-menu-bar a:hover {\n    color: black;\n}\n</style>\n<div id="top-menu-bar">\n</div>';class e extends HTMLElement{constructor(){super(),this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(t.content.cloneNode(!0)),this.$topmenu=this._shadowRoot.querySelector("#top-menu-bar")}connectedCallback(){}setMenu(t){t.forEach((t=>{var e=document.createElement("a");e.setAttribute("href",t.url),e.innerHTML=t.title,this.$topmenu.appendChild(e)}))}static get observedAttributes(){return["value"]}attributeChangedCallback(t,e,n){switch(t){case"value":this.value!=n&&(this.value=n)}}}window.customElements.define("yic-top-menu",e);const n=document.createElement("template");n.innerHTML='<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\n#context-menu-bar a {\n    padding: 14px 16px;\n    text-decoration: none;\n    display: block;\n    color: #333;\n}\n\n#context-menu-bar a:hover {\n    color: black;\n}\n\n</style>\n<div id="context-menu-bar">\n    <p>\n    </p>\n</div>\n';class a extends HTMLElement{constructor(){super(),this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(n.content.cloneNode(!0)),this.$menulist=this._shadowRoot.querySelector("#context-menu-bar p")}connectedCallback(){}setMenu(t){t.forEach((t=>{var e=document.createElement("a");e.setAttribute("href","#"),e.innerHTML=t.title,this.$menulist.appendChild(e)}))}static get observedAttributes(){return["value"]}attributeChangedCallback(t,e,n){switch(t){case"value":this.value!=n&&(this.value=n)}}}window.customElements.define("yic-side-menu",a);class i extends HTMLElement{constructor(){super(),this.definition={},this.dataVault={},this.parent={},this.elementcounter=0,this.webcomponents=[{type:"text",webcomponent:"yic-form-text-input"},{type:"password",webcomponent:"yic-form-password-input"},{type:"email",webcomponent:"yic-form-email-input"},{type:"rows",webcomponent:"yic-form-rows"},{type:"row",webcomponent:"yic-form-row"},{type:"definition",webcomponent:"yic-form-definition"}]}connectedCallback(){}static get observedAttributes(){return[]}attributeChangedCallback(t,e,n){}setCounter(t){this.elementcounter=t}getCounter(){return this.elementcounter}populateElements(t){this.definition=t}populate(t,e,n){this.dataVault=e;var a=this;t.forEach((i=>{this.dataVault.hasElement(i.datapath)&&(this.elementcounter++,this.webcomponents.forEach((o=>{if(i.type==o.type){var s=document.createElement(o.webcomponent);s.dataVault=e,s.datapath=i.datapath,e.register(s,i.datapath),s.addEventListener("dataChanged",(t=>{s.handleDataChange(t.detail)})),s.addEventListener("errorsRaised",(t=>{s.handleError(t.detail)})),s.parent=a,s.setCounter(this.elementcounter),s.populateElements(i),"rows"==i.type?(t=s.buildElementsFromSet(i),s.populate(t,e,s.$children)):i.elements&&s.populate(i.elements,e,s.$children),n.appendChild(s),this.elementcounter=s.getCounter()}})))}))}handleDataChange(t){this.updateValue(t.name)}handleError(t){this.updateErrors(t.name)}updateValue(t){console.log("TODO: override in webcomponent. Data changed for "+t)}updateErrors(t){console.log("TODO: override in webcomponent. Reset errors for "+t)}}window.customElements.define("yic-set-base",i);class o{constructor(t,e){this.data=this.setData(t),this.setDataDefinition(e),this.registrations=[]}setData(t){var e=[];return this.type=Array.isArray(t)?"list":"item","list"==this.type?t.forEach(((t,n)=>{e[n]=[],Object.entries(t).forEach((t=>{e[n].push({name:t[0],value:t[1]})}))})):Object.entries(t).forEach((t=>{e.push({name:t[0],value:t[1],validations:[],type:"",required:!1,errors:[],registered:[]})})),e}setDataDefinition(t){this.datadef=t.definition,this.actions=t.actions,"list"==this.type?this.data.forEach(((t,e)=>{t.forEach(((t,n)=>{this.datadef.elements.forEach((a=>{t.name==a.name&&(this.data[e][n].type=a.type)}))}))})):this.datadef.elements.forEach((t=>{var e=!1;this.data.forEach(((n,a)=>{n.name==t.name&&(e=!0,this.data[a].type=t.type,this.data[a].validations=t.validations,this.data[a].required=t.required)})),e||this.data.push({name:t.name,type:t.type,validations:t.validations,required:t.required})}))}register(t,e){-1==e.indexOf("/")&&this.data.forEach(((n,a)=>{n.name==e&&this.data[a].registered.push(t)}))}getValue(t){var e;return-1==t.indexOf("/")&&this.data.forEach(((n,a)=>{n.name==t&&(e=n.value)})),e}getErrors(t){var e;return-1==t.indexOf("/")&&this.data.forEach(((n,a)=>{n.name==t&&(e=n.errors)})),e}setValue(t,e,n=""){-1==t.indexOf("/")&&this.data.forEach(((n,a)=>{if(n.name==t&&this.data[a].value!==e){this.data[a].value=e,this.data[a].registered.forEach((n=>{var a=new CustomEvent("dataChanged",{detail:{value:e,name:t}});n.dispatchEvent(a)}));var i=[];n.validations.forEach((t=>{var n=this.isInvalid(e,t);n&&i.push(n)})),this.setErrors(t,i)}}))}setErrors(t,e){-1==t.indexOf("/")&&this.data.forEach(((n,a)=>{n.name==t&&this.data[a].errors!==e&&(this.data[a].errors=e,this.data[a].registered.forEach((n=>{var a=new CustomEvent("errorsRaised",{detail:{errors:e,name:t}});n.dispatchEvent(a)})))}))}hasElement(t){var e=!1;return-1==t.indexOf("/")&&this.data.forEach((n=>{n.name==t&&(e=!0)})),e}rowCount(){return this.data.length}getSetElement(t,e){var n={};return this.data[t].forEach((t=>{t.name==e&&(n=t)})),n}getElementDefinition(t){var e=!1;return-1==t.indexOf("/")&&this.datadef.definition.elements.forEach((n=>{n.name==t&&(e=n)})),!1!==e?e:{name:t,required:!1,validations:[],type:"all"}}get(){}save(t,e){var n={},a={};this.actions.forEach((t=>{"CREATE"==t.id?n=t:"UPDATE"==t.id&&(a=t)}));var i=a.action.url,o=!1;a.action.parms.forEach((t=>{if(t.hasOwnProperty("data_item")){var e=this.getValue(t.data_item);void 0!==e?i=i.replace(t.url_item,e):o=!0}}));var s=new XMLHttpRequest;o?s.open(n.action.method,createAction.action.url,!0):s.open(a.action.method,i,!0),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE){var n=s.status;0===n||n>=200&&n<400?e(s.responseText):t(s.responseText)}};var r={};switch(this.datadef.dataformat.type){case"phoenix":var d={};this.data.forEach((t=>{d[t.name]=t.value})),r[this.datadef.dataformat.base]=d;break;default:this.data.forEach((t=>{r[t.name]=t.value}))}s.send(JSON.stringify(r))}delete(){this.actions.forEach((t=>{t.id}))}}const s=document.createElement("template");s.innerHTML='<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\nh2 {\n    padding: 20px 50px;\n    margin: 50px 50px 0px;\n    border-bottom: 2px solid #ccc;\n    max-width:400px;\n}\n\n.container {\n    margin: 0px 50px 50px;\n    padding: 20px 50px;\n    max-width:400px;\n}\n\n</style>\n<h2></h2>\n<div class="container">\n    <form id="yic-form" action="" name="" method="POST" enctype="application/x-www-form-urlencoded">\n    </form>\n</div>\n',window.customElements.define("yic-form",class extends i{constructor(){super(),this.pageElement={},this.definition={elements:[],action:"",name:""},this.elementcounter=0,this.type="form",this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(s.content.cloneNode(!0)),this.$children=this._shadowRoot.querySelector("#yic-form"),this.$title=this._shadowRoot.querySelector("h2")}setDataVault(t,e){this.datavault=new o(t,e)}setDefinition(t){this.pageElement=t,this.definition=t.definition,this.formActions=t.definition.formactions}populateForm(){this.$title.innerHTML=this.definition.title,this.populate(this.definition.elements,this.datavault,this.$children);var t=document.createElement("yic-form-submit");t.addEventListener("click",this.submitForm.bind(this)),this.$children.appendChild(t)}propagateValue(t,e){if(t.startsWith(this.internalId)){var n=this.internalId.substring(t.length);this.definition.elements.forEach(((t,a)=>{t.name==n&&(t.value=e,this.definition.elements[a]=t)}))}}submitForm(){this.datavault.save(this.handleError.bind(this),this.handleSucces.bind(this))}handleError(t){console.log("Error: "+t);var e=JSON.parse(t);Object.entries(e.errors).forEach((([t,e])=>{this.dataVault.setErrors(t,e)}))}handleSucces(t){console.log("Succes: "+t)}static get observedAttributes(){return["value"]}attributeChangedCallback(t,e,n){switch(t){case"value":this.value!=n&&(this.value=n)}}});const r=document.createElement("template");r.innerHTML='<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\nh2 {\n    margin: 50px 50px 0px;\n    padding: 20px 50px;\n    max-width:1200px;\n    border-bottom: 2px solid #ccc;\n}\n\n.container {\n    margin: 0px 50px 50px;\n    padding: 20px 50px;\n    max-width:1200px;\n}\n\ntable {\n    border-collapse: collapse;\n    min-width: 400px;\n    box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);\n}\n\ntable thead tr {\n    background-color: #009879;\n    color: #ffffff;\n    text-align: left;\n}\n\ntable th,\ntable td {\n    padding: 12px 15px;\n}\n\ntbody tr {\n    border-bottom: 1px solid #dddddd;\n}\n\ntbody tr:nth-of-type(even) {\n    background-color: #f3f3f3;\n}\n\ntbody tr:last-of-type {\n    border-bottom: 2px solid #009879;\n}\n\n</style>\n<h2></h2>\n<div class="container">\n    <div id="yic-overview"></div>\n    <table>\n        <thead>\n        </thead>\n        <tbody>\n        </tbody>\n        <tfoot>\n        </tfoot>\n    </table>\n</div>\n';class d extends HTMLElement{constructor(){super(),this.pageElement={},this.definition={elements:[],action:"",name:""},this.type="overview",this.columns=[],this.formActions=[],this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(r.content.cloneNode(!0)),this.$children=this._shadowRoot.querySelector("#yic-overview"),this.$title=this._shadowRoot.querySelector("h2"),this.$header=this._shadowRoot.querySelector("thead"),this.$body=this._shadowRoot.querySelector("tbody")}connectedCallback(){}setDataVault(t,e){this.datavault=new o(t,e)}setDefinition(t){this.pageElement=t,this.definition=t.definition}populate(){this.populateHeader();for(var t=this.datavault.rowCount(),e=0;e<t;e++){var n=document.createElement("tr");this.populateRow(n,e),this.$body.appendChild(n)}}handleCall(t){if("FORM"==this.formActions[t].type){var e=new String(this.formActions[t].action.url).replace(/@id/i,this.formActions[t].element.value);window.location.href=e}}populateRow(t,e){this.columns.forEach((n=>{var a=document.createElement("td");switch(n.type){case"actions":n.items.forEach((t=>{a.appendChild(this.createActionButton(t,e))}));break;default:var i=this.datavault.getSetElement(e,n.datapath);a.innerHTML=i.value}t.appendChild(a)}))}createActionButton(t,e){var n=this.CreateFormAction(t,e),a=document.createElement("yic-form-action");return a.setAttribute("label",t.label),a.addEventListener("click",(()=>{this.handleCall(n)})),a}CreateFormAction(t,e){var n;return"FORM"==t.object?this.definition.formactions.forEach((a=>{if(a.id==t.action){var i={};i.action=a.action,i.element=this.datavault.getSetElement(e,"id"),i.type=t.object,n=this.formActions.push(i)-1}})):"DATA"==t.object&&this.datavault.actions.forEach((a=>{if(a.id==t.action){var i={};i.action=a.action,i.element=this.datavault.getSetElement(e,"id"),i.type=t.object,n=this.formActions.push(i)-1}})),n}populateHeader(){var t=document.createElement("tr");this.$title.innerHTML=this.definition.title,this.definition.elements.forEach((e=>{var n=document.createElement("th");n.innerHTML=e.label,this.columns.push(e),t.appendChild(n)})),this.$header.appendChild(t)}static get observedAttributes(){return["value"]}attributeChangedCallback(t,e,n){switch(t){case"value":this.value!=n&&(this.value=n)}}}window.customElements.define("yic-overview",d);const l=document.createElement("template");l.innerHTML='<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\np { margin-top: 20px; }\n\ninput[type="submit"] {\n    font: 16px/1.6 Arial, sans-serif;\n    color: white;\n    background: cornflowerblue;\n    border: 1px solid #1f66e5;\n    border-radius: 4px;\n    padding: 10px 10px;\n    width: 100%;\n}\n\n</style>\n<p>\n    <input name="" type="submit"></input>\n</p>\n';class h extends HTMLElement{constructor(){super(),this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(l.content.cloneNode(!0)),this.$form=this._shadowRoot.querySelector("#yic-form")}connectedCallback(){}static get observedAttributes(){return["value","label","required","name","count"]}attributeChangedCallback(t,e,n){switch(t){case"name":this._shadowRoot.querySelector("input").getAttribute("name")!=n&&this._shadowRoot.querySelector("input").setAttribute("name",n);break;case"label":this._shadowRoot.querySelector("label").innerHTML!=n&&(this._shadowRoot.querySelector("label").innerHTML=n);break;case"value":this.value!=n&&(this.value=n)}}}window.customElements.define("yic-form-submit",h);const c=document.createElement("template");c.innerHTML="<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\nbutton {\n    font: 16px/1.6 Arial, sans-serif;\n    color: white;\n    background: cornflowerblue;\n    border: 1px solid #1f66e5;\n    border-radius: 4px;\n    padding: 5px 5px;\n    margin:5px;\n    width: 100%;\n}\n\n</style>\n<button>BUTTON</button>\n";class u extends HTMLElement{constructor(){super(),this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(c.content.cloneNode(!0)),this.$button=this._shadowRoot.querySelector("button")}connectedCallback(){}static get observedAttributes(){return["label","name"]}attributeChangedCallback(t,e,n){switch(t){case"name":this.$button.getAttribute("name")!=n&&this.$button.setAttribute("name",n);break;case"label":this.$button.innerHTML!=n&&(this.$button.innerHTML=n)}}}window.customElements.define("yic-form-action",u);const p=document.createElement("template");p.innerHTML='<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\np { margin: 0; }\n\np.second { margin-top: 20px; }\n\na { color: #1f66e5; }\n\nlabel { \n    display: block; \n    margin-bottom: 5px; \n}\n\n.error {\n    display: block; \n    color: red;\n    font-style: italic;\n}\n\ninput[type="text"],\ninput[type="password"] {\n    background-color: #eaeaea;\n    border: 1px solid grey;\n    border-radius: 4px;\n    box-sizing: border-box;\n    color: inherit;\n    font: inherit;\n    padding: 10px 10px;\n    width: 100%;\n}\n\ninput[type="submit"] {\n    font: 16px/1.6 Arial, sans-serif;\n    color: white;\n    background: cornflowerblue;\n    border: 1px solid #1f66e5;\n    border-radius: 4px;\n    padding: 10px 10px;\n    width: 100%;\n}\n\n</style>\n<p>\n    <label></label>\n    <input name="" type="text"></input>\n    <div class="errors"></div>\n</p>\n',window.customElements.define("yic-form-text-input",class extends i{constructor(){super(),this.elementcounter=0,this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(p.content.cloneNode(!0)),this.$field=this._shadowRoot.querySelector("input"),this.$field.addEventListener("change",this.handleValueChange.bind(this)),this.$errors=this._shadowRoot.querySelector(".errors")}connectedCallback(){}handleValueChange(t){this.setAttribute("value",t.target.value),this.dataVault.setValue(this.datapath,t.target.value)}populateElements(t){this.definition=t,this.datapath=t.datapath,this.setAttribute("name",t.name),this.setAttribute("count",this.elementcounter),this.setAttribute("label",t.label),this.setAttribute("required",t.required);var e=this.dataVault.getValue(t.datapath);void 0!==e&&this.setAttribute("value",e)}updateErrors(t){var e=this.dataVault.getErrors(t);this.$errors.innerHTML="",e.forEach((t=>{var e=document.createElement("div");e.className="error",e.innerHTML=t,this.$errors.appendChild(e)}))}static get observedAttributes(){return["value","label","required","name","count"]}attributeChangedCallback(t,e,n){switch(t){case"name":this.$field.getAttribute("name")!=n&&(this.name=n,this.$field.setAttribute("name",n));break;case"label":this._shadowRoot.querySelector("label").innerHTML!=n&&(this._shadowRoot.querySelector("label").innerHTML=n);break;case"count":n>1&&this._shadowRoot.querySelector("p").classList.add("second");break;case"required":break;case"value":this.value!=n&&this.$field.setAttribute("value",n)}}});const m=document.createElement("template");m.innerHTML='<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\np { margin: 0; }\n\np.second { margin-top: 20px; }\n\nlabel { \n    display: block; \n    margin-bottom: 5px; \n}\n\ninput[type="text"],\ninput[type="password"] {\n    background-color: #eaeaea;\n    border: 1px solid grey;\n    border-radius: 4px;\n    box-sizing: border-box;\n    color: inherit;\n    font: inherit;\n    padding: 10px 10px;\n    width: 100%;\n}\n\n</style>\n<p>\n    <label></label>\n    <input name="" type="text"></input>\n</p>\n',window.customElements.define("yic-form-email-input",class extends i{constructor(){super(),this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(m.content.cloneNode(!0)),this.$field=this._shadowRoot.querySelector("input"),this.$field.addEventListener("change",this.handleValueChange.bind(this))}connectedCallback(){}handleValueChange(t){this.setAttribute("value",t.target.value),this.dataVault.setValue(this.datapath,t.target.value)}populateElements(t){this.definition=t,this.datapath=t.datapath,this.setAttribute("name",t.name),this.setAttribute("count",this.elementcounter),this.setAttribute("label",t.label),this.setAttribute("required",t.required);var e=this.dataVault.getValue(t.datapath);void 0!==e&&this.setAttribute("value",e)}static get observedAttributes(){return["value","label","required","name","count"]}attributeChangedCallback(t,e,n){switch(t){case"name":this.$field.getAttribute("name")!=n&&(this.name=n,this.$field.setAttribute("name",n));break;case"label":this._shadowRoot.querySelector("label").innerHTML!=n&&(this._shadowRoot.querySelector("label").innerHTML=n);break;case"count":n>1&&this._shadowRoot.querySelector("p").classList.add("second");break;case"required":break;case"value":this.$field.getAttribute("value")!=n&&this.$field.setAttribute("value",n)}}});const b=document.createElement("template");b.innerHTML='<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\np { margin: 0; }\n\np.second { margin-top: 20px; }\n\na { color: #1f66e5; }\n\nlabel { \n    display: block; \n    margin-bottom: 5px; \n}\n\ninput[type="text"],\ninput[type="password"] {\n    background-color: #eaeaea;\n    border: 1px solid grey;\n    border-radius: 4px;\n    box-sizing: border-box;\n    color: inherit;\n    font: inherit;\n    padding: 10px 10px;\n    width: 100%;\n}\n\ninput[type="submit"] {\n    font: 16px/1.6 Arial, sans-serif;\n    color: white;\n    background: cornflowerblue;\n    border: 1px solid #1f66e5;\n    border-radius: 4px;\n    padding: 10px 10px;\n    width: 100%;\n}\n\n</style>\n<p>\n    <label></label>\n    <input name="" type="password"></input>\n</p>\n',window.customElements.define("yic-form-password-input",class extends i{constructor(){super(),this.elementcounter=0,this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(b.content.cloneNode(!0)),this.$field=this._shadowRoot.querySelector("input"),this.$field.addEventListener("change",this.handleValueChange.bind(this))}connectedCallback(){}handleValueChange(t){this.setAttribute("value",t.target.value),this.dataVault.setValue(this.datapath,t.target.value)}populateElements(t){this.definition=t,this.datapath=t.datapath,this.setAttribute("name",t.name),this.setAttribute("count",this.elementcounter),this.setAttribute("label",t.label),this.setAttribute("required",t.required);var e=this.dataVault.getValue(t.datapath);void 0!==e&&this.setAttribute("value",e)}static get observedAttributes(){return["value","label","required","name","count"]}attributeChangedCallback(t,e,n){switch(t){case"name":this.$field.getAttribute("name")!=n&&(this.name=n,this.$field.setAttribute("name",n));break;case"label":this._shadowRoot.querySelector("label").innerHTML!=n&&(this._shadowRoot.querySelector("label").innerHTML=n);break;case"count":n>1&&this._shadowRoot.querySelector("p").classList.add("second");break;case"required":break;case"value":this.value!=n&&this.$field.setAttribute("value",n)}}});const f=document.createElement("template");f.innerHTML='<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\nh2 {\n    padding: 20px 50px;\n    margin: 50px 50px 0px;\n    border-bottom: 2px solid #ccc;\n    max-width:400px;\n}\n\n.container {\n    margin: 0px 0px 50px;\n    padding: 20px 0px;\n    max-width:400px;\n}\n\n#rowsheader {\n    width: 100%;\n    background-color: #ccc;\n}\n\n</style>\n<div class="container">\n    <div id="rowsheader">\n        <span id="rowstitle"></span>\n        <button id="addrow">+</button>\n    </div>\n    <div id="rowscontent"></div>\n</div>\n',window.customElements.define("yic-form-rows",class extends i{constructor(){super(),this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(f.content.cloneNode(!0)),this.$header=this._shadowRoot.querySelector("#rowstitle"),this.$children=this._shadowRoot.querySelector("#rowscontent"),this.$addbutton=this._shadowRoot.querySelector("#addrow"),this.$addbutton.addEventListener("click",this.addRow.bind(this))}addRow(){this.dataVault.addSetItem(this.definition.datapath),this.updateRows()}updateRows(){this.$children.innerHTML="",this.populate(this.buildElementsFromSet(this.definition),this.dataVault,this.$children)}connectedCallback(){}buildElementsFromSet(t){var e=[];return this.dataVault.getSetItems(t.datapath).forEach((n=>{var a=JSON.stringify(t.rowdef),i=`"datapath":"${t.datapath}/*`,o=`"datapath":"${t.datapath}/${n.setid}`,s=a.replaceAll(i,o);e.push(JSON.parse(s))})),e}populateElements(t){this.definition=t,this.setAttribute("name",t.name),this.$header.innerHTML=t.title}static get observedAttributes(){return["name"]}attributeChangedCallback(t,e,n){switch(t){case"name":this.name!=n&&(this.name=n)}}});const w=document.createElement("template");w.innerHTML='<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\nh2 {\n    padding: 20px 50px;\n    margin: 50px 50px 0px;\n    border-bottom: 2px solid #ccc;\n    max-width:400px;\n}\n\n.container {\n    margin: 0px 50px 50px;\n    padding: 20px 50px;\n    max-width:400px;\n}\n\n.row {\n    width: 100%;\n}\n</style>\n<div>\n    <div class="rowheader">\n        <button id="removerow">-</button>\n    </div>\n    <div class="rowcontent"></div>\n</div>\n',window.customElements.define("yic-form-row",class extends i{constructor(){super(),this.elementcouter=0,this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(w.content.cloneNode(!0)),this.$children=this._shadowRoot.querySelector(".rowcontent"),this.$button=this._shadowRoot.querySelector("#removerow"),this.$button.addEventListener("click",this.removeRow.bind(this))}connectedCallback(){}removeRow(){this.dataVault.removeSetItem(this.datapath),this.parent.updateRows()}populateElements(t){this.definition=t,this.datapath=t.datapath,this.setAttribute("name",t.name)}static get observedAttributes(){return["name"]}attributeChangedCallback(t,e,n){switch(t){case"name":e!=n&&(this.name=n)}}});const v=document.createElement("template");v.innerHTML='<style>\n:host {\n    color: #333333;\n    font: 16px Arial, sans-serif;\n}\n\nh2 {\n    padding: 20px 50px;\n    margin: 50px 50px 0px;\n    border-bottom: 2px solid #ccc;\n    max-width:400px;\n}\n\n.container {\n    margin: 0px 50px 50px;\n    padding: 20px 50px;\n    max-width:400px;\n}\n\n</style>\n<div id="definitionfield">\n</div>\n',window.customElements.define("yic-form-definition",class extends i{constructor(){super(),this.definition={},this.elementcounter=0,this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(v.content.cloneNode(!0)),this.$children=this._shadowRoot.querySelector("definitionfield")}connectedCallback(){}populateElements(t){this.setAttribute("name",t.name)}static get observedAttributes(){return["value","name"]}attributeChangedCallback(t,e,n){switch(t){case"value":e!=n&&(this.value=n);break;case"name":e!=n&&(this.name=n)}}}),new class{constructor(){fetch(this.buildPath()).then((t=>t.json())).then((t=>{var e=t.data.definition;this.setMenu(e.menu),this.setContent(e.main.pageelement,e.main.data,e.main.datadef)}))}buildPath(){var t=window.location.search,e="";return t.length>0&&(t=t.substr(1)).split("&").forEach((t=>{var n=t.split("=");if("path"==n[0]){var a=(e=n[1]).split("/");if(a.length<=2)e="name="+e;else{var i=a.pop();isNaN(parseInt(i))?e="name="+e:(a.push("@id"),e="name="+a.join("/")+"&id="+i)}}})),"http://localhost:4000/publisher/publications/byname?"+e}setMenu(t){document.querySelector("yic-top-menu").setMenu(t.topMenu),0==t.contextMenu.length?(document.querySelector("#content").classList.remove("extended"),document.querySelector("#content").classList.add("collapsed")):(document.querySelector("yic-side-menu").setMenu(t.contextMenu),document.querySelector("#content").classList.remove("collapsed"),document.querySelector("#content").classList.add("extended"))}setContent(t,e,n){switch(t.definition.type){case"overview":var a=document.createElement("yic-overview");a.setDataVault(e,n),a.setDefinition(t),a.populate(),document.querySelector("#main-content").appendChild(a);break;case"detail":var i=document.createElement("yic-form");i.setDataVault(e,n),i.setDefinition(t),i.populateForm(),document.querySelector("#main-content").appendChild(i)}}}})();